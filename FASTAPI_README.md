# FastAPI Setup and Testing Guide

## Quick Start

1. **Install dependencies:**

   ```bash
   pip install -r requirements.txt
   ```

2. **Set up environment variables:**

   - Copy `.env.example` to `.env`
   - Fill in your Azure Speech Service credentials:
     ```
     AZURE_SPEECH_ENDPOINT=https://your-region.api.cognitive.microsoft.com/
     AZURE_SPEECH_KEY=your-key-here
     AZURE_SPEECH_VOICE_NAME=en-US-JennyNeural
     OPENAI_API_KEY=your-openai-key-here
     ```

3. **Run the FastAPI server:**

   ```bash
   python run_server.py
   ```

   Or directly with uvicorn:

   ```bash
   uvicorn src.miramind.api.main:app --reload --host 0.0.0.0 --port 8000
   ```

4. **Test the API:**

   ```bash
   python test_api.py
   ```

5. **Run the frontend:**
   ```bash
   cd src/miramind/frontend
   npm install
   npm run dev
   ```

## API Endpoints

- `GET /api/test` - Test endpoint
- `POST /api/chat/start` - Initialize chat session
- `POST /api/chat/message` - Send chat message

## Troubleshooting

1. **No audio/response in frontend:**

   - Check if the API server is running on port 8000
   - Check browser console for errors
   - Verify that `/static/output.wav` is accessible
   - Check FastAPI logs for subprocess errors

2. **Subprocess errors:**

   - Ensure Python environment has all required packages
   - Check that `run_chat.py` works standalone
   - Verify the working directory is set correctly

3. **Audio file not found:**
   - Check if the `frontend/public` directory exists
   - Verify audio file is being generated by the TTS service
   - Check static file mounting in FastAPI

## Development

The main components are:

- **FastAPI API**: `src/miramind/api/main.py`
- **Chat Logic**: `src/miramind/llm/langgraph/run_chat.py`
- **Frontend**: `src/miramind/frontend/app/call/page.jsx`
